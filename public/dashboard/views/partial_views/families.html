
<div class="row">
  <h1 class="section-header">Families</h1>  

  <hr>
</div>

<div ng-controller="FamilyCtrl">
      
      <div class="row bot10" id="operation">
        <div class="col-md-6">
          <div class="input-group col-md-8">
            <input type="search" class="search-query form-control" placeholder="Type here"
              ng-model="searchFamily" />
            <span class="input-group-btn">
              <button class="btn btn-danger" type="button">
                <span class="glyphicon glyphicon-search"></span>
              </button>
            </span>
          </div>
        </div>

        <div class="controls col-md-offset-3 col-md-3 pull-right">
          <button type="button" class="btn btn-success btn-sm" 
                  data-toggle="collapse" data-parent="#operation" href="#formInsert">
            <span class="glyphicon glyphicon-plus"></span> Add new
          </button>

          <button type="button" class="btn btn-primary btn-sm" ng-click="showEditFamily = !showEditFamily">
            <span class="glyphicon glyphicon-pencil"></span> Edit
          </button>
        </div>
      </div>

      <div id="formInsert" class="top10 bot10 panel-collapse collapse out row col-md-6 col-md-offset-3 text-center panel panel-primary window-appearance">

        <h4>Create family</h3>

        <div class="panel-body">
          <form class="form-horizontal">
            <fieldset>

              <!-- Text input-->
              <div class="control-group">
                <label class="control-label" for="nameFamily">Name</label>
                <div class="controls">
                  <input id="nameFamily" name="nameFamily" type="text" placeholder="" class="form-control input-xlarge" ng-model="family.name">
                </div>
              </div>

              <!-- Button (Double) -->
              <div class="control-group top10">
                <div class="controls">
                  <button id="save_btn" name="save_btn" class="btn btn-success" ng-click="createFamily(family)">Save</button>
                  <button id="cancel_btn" name="cancel_btn" class="btn btn-danger" ng-click="cancel()">Cancel</button>
                </div>
              </div>

            </fieldset>
          </form>
        </div>
      </div>

      <div id="patientsPanel" class="top10 bot10 panel-collapse collapse out row">
        <div class="panel panel-primary col-md-6">
          <h4>Patients out family</h3>

         <ul class="list-group">
            <li class="list-group-item" ng-repeat="patient in outPatients">
              <div class="row">
                  <div class="pull-left">{{ patient._id }}</div>
                  <div class="pull-right">  
                    <button type="button" class="btn btn-success btn-sm" ng-click="addPatient(patient)">
                            <span class="glyphicon glyphicon-plus"></span>
                    </button>
                  </div>
              </div>
            </li>
          </ul>

        </div>

        <div class="panel panel-primary col-md-6">
          <h4>Patients in family</h3>

          <ul class="list-group" >
              <li class="list-group-item" ng-repeat="patient in inPatients">
                <div class="row">
                  <div class="pull-left">{{ patient._id }}</div>
                  <div class="pull-right">  
                    <button type="button" class="btn btn-danger btn-sm" ng-click="removePatient(patient)">
                            <span class="glyphicon glyphicon-trash"></span>
                    </button>
                  </div>
                </div>
              </li>
          
          </ul>
        </div>
      </div>

      <div class="row">
          <table class="table table-bordered" ng-show="!showEditFamily">
            <thead>
              <tr>
                <th>Name</th>
                <th>Members</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="family in families | filter:searchFamily "> 
                  <td>{{ family.name }}</td>
                  <td>Mario, Antonio, Anna</td>                  
              </tr>
              <tr>
              </tr>
            </tbody>
          </table>

          <table class="table table-bordered" ng-show="showEditFamily">
            <thead>
              <tr>
                <th>Name</th>
                <th>Operation</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="family in families | filter:searchFamily "> 
                  <td>
                    <div ng-show="!showConfirm">{{ family.name }}</div>
                    <input id="nameUpdate" name="nameUpdate" type="text" value="{{ family.name }}" class="form-control input-xlarge" ng-model="familyUpdate.name" ng-show="showConfirm">
                  </td>
                  <td>
                    <div class="control-group pull-right" ng-show="!showConfirm">
                      <div class="controls" id="controlsBtn">
                        <button type="button" class="btn btn-success btn-sm" ng-click="showConfirm = !showConfirm">
                          <span class="glyphicon glyphicon-pencil"></span> Edit Name
                        </button>
                        <button type="button" class="btn btn-primary btn-sm" 
                                data-toggle="collapse" data-parent="#controlsBtn" href="#patientsPanel"
                                ng-click="showPatients(family)">
                          <span class="glyphicon glyphicon-pencil"></span> Edit Patients
                        </button>
                        <button type="button" class="btn btn-danger btn-sm" ng-click="removeFamily(family)">
                          <span class="glyphicon glyphicon-trash"></span> Remove
                        </button>
                      </div>
                    </div>

                    <div class="control-group pull-right" ng-show="showConfirm">
                      <div class="controls">
                        <button type="button" class="btn btn-success btn-sm" ng-click="updateFamily(family, familyUpdate)">
                          <span class="glyphicon glyphicon-pencil" ng-click="showConfirm = false"></span> OK
                        </button>
                        <button type="button" class="btn btn-danger btn-sm" ng-click="showConfirm = false">
                          <span class="glyphicon glyphicon-ban-circle" ></span> Cancel
                        </button>
                      </div>
                    </div>
                  </td>
              </tr>
              <tr>
              </tr>
            </tbody>
          </table>
      </div>


</div>

   

</div>

<div id="myModalLicensed" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content"></div>
  </div>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close " data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel">Edit</h3>
      </div>
      <div class="modal-body">
        <p class="error-text">
          <div>

            <div id="myTabContent" class="tab-content">

              <!-- Aggiunta/Rimozione membri -->
              <div style="margin-left: 15px">
                <div class="row bot15">
                  <div id="custom-search-input">
                    <h4>Insert <i>Username</i>, <i>First Name</i> or <i>Last Name</i> to search:</h4>
                    <div class="input-group col-md-4">
                      <input type="search" class="search-query form-control" placeholder="Type here" />
                      <span class="input-group-btn">
                        <button class="btn btn-danger" type="button">
                          <span class="glyphicon glyphicon-search"></span>
                        </button>
                      </span>
                    </div>
                  </div>
                </div>
                
                <div class="row">
                  <div class="well">
                    <table class="table">
                      <thead>
                        <tr>
                          <th class="col-lg-3"></th>
                          <th>First Name</th>
                          <th>Last Name</th>
                          <th>Username</th>
                          <th style="width: 75px;"></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td><div class="col-md-3 col-lg-3 " align="center"> <img alt="User Pic" src="https://lh5.googleusercontent.com/-b0-k99FZlyE/AAAAAAAAAAI/AAAAAAAAAAA/eu7opA4byxI/photo.jpg?sz=100" class="img-circle"> </div></td>
                          <td>Chris</td>
                          <td>Albert</td>
                          <td>cab79</td>
                          <td>
                            <button type="button" class="btn btn-primary btn-sm" data-ng-hide="user.isLicensed"
                            data-toggle="modal" data-target="#myModalLicensed">
                            <span class="glyphicon glyphicon-plus"></span> Add
                          </button> 
                        </td>
                      </tr>
                      <tr>
                        <td>(Tutti i membri della famiglia e poi tuti gli altri membri del db; dopo una ricerca mostra solo i risultati)</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>(+ se non fa parte della famiglia, - se fa parte)</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>    
            <!-- Aggiunta/Rimozione membri fine-->

          </div>
        </div>
      </p>
    </div>
    <div class="modal-footer">
      <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
      <button class="btn btn-danger" data-dismiss="modal">OK</button>
    </div>
  </div>
</div>
</div>



<div id="myModalAdd" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content"></div>
  </div>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close " data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel">Add</h3>
      </div>
      <div class="modal-body">
        <p class="error-text">
          <div>
            <div id="myTabContent" class="tab-content">

              <!-- Aggiunta membri -->
              <div style="margin-left: 15px">
                <div class="row bot15">
                  <div id="custom-search-input">
                    <h4>Insert <i>Username</i>, <i>First Name</i> or <i>Last Name</i> to search:</h4>
                    <div class="input-group col-md-4">
                      <input type="search" class="search-query form-control" placeholder="Type here" />
                      <span class="input-group-btn">
                        <button class="btn btn-danger" type="button">
                          <span class="glyphicon glyphicon-search"></span>
                        </button>
                      </span>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="well">
                    <table class="table">
                      <thead>
                        <tr>
                          <th class="col-lg-3"></th>
                          <th>First Name</th>
                          <th>Last Name</th>
                          <th>Username</th>
                          <th style="width: 75px;"></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td><div class="col-md-3 col-lg-3 " align="center"> <img alt="User Pic" src="https://lh5.googleusercontent.com/-b0-k99FZlyE/AAAAAAAAAAI/AAAAAAAAAAA/eu7opA4byxI/photo.jpg?sz=100" class="img-circle"> </div></td>
                          <td>Chris</td>
                          <td>Albert</td>
                          <td>cab79</td>
                          <td>
                            <button type="button" class="btn btn-primary btn-sm" data-ng-hide="user.isLicensed"
                            data-toggle="modal" data-target="#myModalLicensed">
                            <span class="glyphicon glyphicon-plus"></span> Add
                          </button> 
                        </td>
                      </tr>
                      <tr>
                        <td>(All'inizio mostra tutti gli utenti esistenti e dopo una ricerca mostra solo i risultati)</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>    
            <!-- Aggiunta membri fine-->

          </div>
        </div>
      </p>
    </div>
    <div class="modal-footer">
      <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
      <button class="btn btn-danger" data-dismiss="modal">OK</button>
    </div>
  </div>
</div>
</div>